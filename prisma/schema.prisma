generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model user {
  id_user                 Int                      @id @default(autoincrement())
  username                String                   @unique
  firstName               String?                  @db.VarChar(16)
  lastName                String?                  @db.VarChar(16)
  email                   String                   @unique @db.VarChar(64)
  password                String                   @db.VarChar(128)
  role                    role                     @default(USER)
  avatarPath              String?
  passwordVersion         Int
  blogPosts               blogPost[]               @relation("Author")
  refresh_password_tokens refresh_password_tokens?
}

model blogPost {
  id_blogpost String     @id @unique @default(uuid())
  date        DateTime   @default(now())
  lastUpdated DateTime   @updatedAt
  title       String
  description String
  content     String
  id_author   Int
  autohor     user       @relation("Author", fields: [id_author], references: [id_user], onDelete: Cascade)
  categories  category[] @relation("blogPostTocategory")
}

model category {
  id    Int        @id @default(autoincrement())
  name  String
  posts blogPost[] @relation("blogPostTocategory")
}

model refresh_password_tokens {
  id_token   Int     @id @default(autoincrement())
  token      String?
  id_user    Int     @unique
  expires_at BigInt?
  used       Boolean
  user       user    @relation(fields: [id_user], references: [id_user], onDelete: Cascade, onUpdate: NoAction)
}

enum role {
  USER
  ADMIN
}
